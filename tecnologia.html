<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <title>Tecnologia</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav>
    <ul>
      <li><a href="index.html">Inici</a></li>
      <li><a href="tecnologia.html">Tecnologia</a></li>
      <li><a href="matematiques.html">Matemàtiques</a></li>
      <li><a href="llengua.html">Llengua</a></li>
    </ul>
  </nav>
  <main>
    <h1>Tecnologia</h1>
    <p class="description">
    Per mostrar aquestes dades, he utilitzat una placa ESP32 equipada amb sensors ambientals. Mitjançant ArduinoBlocks he programat la lectura de temperatura i llum, i la seva transmissió mitjançant WiFi. Aquestes dades s'envien a una pàgina web que he dissenyat jo mateix amb HTML, on també he afegit botons per controlar actuadors com un LED o un servo.
    </p>
    <div class="sensor-box">
      <h2>Dades del robot</h2>
      <p>Temperatura: <span id="temp">--</span> ºC</p>
      <p>Llum: <span id="llum">--</span></p>
    </div>
    <div class="sensor-box">
      <h2>Control del robot</h2>
      <button onclick="enviarOrdre('led_on')">Encén el LED</button>
      <button onclick="enviarOrdre('led_off')">Apaga el LED</button>
      <button onclick="enviarOrdre('servo_dreta')">Gira servo dreta</button>
      <button onclick="enviarOrdre('servo_esquerra')">Gira servo esquerra</button>
    </div>
  </main>
  <script>
    const ipRobot = "http://192.168.1.123"; // Canvia per la IP real de l'ESP32

    function actualitzarDades() {
      fetch(ipRobot + "/dades")
        .then(res => res.json())
        .then(data => {
          document.getElementById("temp").innerText = data.temperatura;
          document.getElementById("llum").innerText = data.llum;
        })
        .catch(err => console.error("Error en rebre dades:", err));
    }

    function enviarOrdre(ordre) {
      fetch(ipRobot + "/actua?ordre=" + ordre)
        .then(() => console.log("Ordre enviada:", ordre))
        .catch(err => console.error("Error en enviar ordre:", err));
    }

    setInterval(actualitzarDades, 3000);
    actualitzarDades();
  </script>
</body>
</html>
